window.__require=function t(e,o,i){function a(r,c){if(!o[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(n)return n(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var p=o[r]={exports:{}};e[r][0].call(p.exports,function(t){return a(e[r][1][t]||t)},p,p.exports,t,e,o,i)}return o[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)a(i[r]);return a}({bullet:[function(t,e,o){"use strict";cc._RF.push(e,"bec3eXqZSlO66PUx9KBHkrL","bullet");var i,a=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(r=(n<3?a(r):n>3?a(e,o,r):a(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetPosition=cc.v2(0,0),e.bulletManager=null,e.isTriggered=!1,e}return a(e,t),e.prototype.init=function(t,e,o){this.setInitPos(t,o),this.bulletMove(),this.targetPosition=e},e.prototype.reuse=function(t){this.bulletManager=t,this.isTriggered=!1},e.prototype.setInitPos=function(t){this.node.parent=t.parent,this.node.setPosition(cc.v2(0,0)),this.node.position=this.node.position.addSelf(t.position)},e.prototype.bulletMove=function(){var t=this,e=cc.moveTo(.2,this.targetPosition),o=cc.callFunc(function(){t.bulletManager.put(t.node)});this.scheduleOnce(function(){t.node.runAction(cc.sequence(e,o))})},e.prototype.onBeginContact=function(t,e,o){var i=this;1!=o.tag?(this.node.stopAllActions(),this.unscheduleAllCallbacks(),this.scheduleOnce(function(){i.bulletManager.put(i.node)},.1)):t.disabled=!0},n([c],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],enemy:[function(t,e,o){"use strict";cc._RF.push(e,"21e92XrQR1KC5am5+uTnqKr","enemy");var i,a=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(r=(n<3?a(r):n>3?a(e,o,r):a(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./player"),c=cc._decorator,s=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player1=null,e.player2=null,e.detectRange=100,e.attackRange=5,e.attackCooldown=1,e.moveSpeed=40,e.tracingPlayer=0,e.moveDir=cc.Vec2.ZERO,e.moveDuration=2,e.waitDuration=1.5,e.nextWaitTime=0,e.nextMoveTime=0,e.waitRandomFactor=.1,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.wandering=function(t){var e,o=cc.director.getTotalTime()/1e3;o>=this.nextMoveTime&&(this.nextWaitTime=o+this.moveDuration,this.nextMoveTime=this.nextWaitTime+this.waitDuration*(1+this.waitRandomFactor*(2*Math.random()-1)),this.moveDir=(e=Math.random()*Math.PI*2,new cc.Vec2(Math.cos(e),Math.sin(e)))),o<this.nextWaitTime&&(this.node.x+=this.moveDir.x*this.moveSpeed*t,this.node.y+=this.moveDir.y*this.moveSpeed*t)},e.prototype.tracing=function(t){var e=cc.v3(0,0,0);e=1==this.tracingPlayer?this.player1.node.position.sub(this.node.position).normalize():this.player2.node.position.sub(this.node.position).normalize(),this.moveDir=cc.v2(e.x,e.y),this.node.x+=this.moveDir.x*this.moveSpeed*t,this.node.y+=this.moveDir.y*this.moveSpeed*t},e.prototype.detectRangePlayer=function(){return this.node.position.sub(this.player1.node.position).mag()<this.detectRange&&(this.moveSpeed=200,this.tracingPlayer=1),this.node.position.sub(this.player2.node.position).mag()<this.detectRange&&(this.tracingPlayer=2,this.moveSpeed=200),0},e.prototype.update=function(t){this.tracingPlayer?this.tracing(t):(this.wandering(t),this.detectRangePlayer())},n([l(r.default)],e.prototype,"player1",void 0),n([l(r.default)],e.prototype,"player2",void 0),n([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./player":"player"}],gamerManager:[function(t,e,o){"use strict";cc._RF.push(e,"9e7e14agd9NuLW2mQVAqQh0","gamerManager");var i,a=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(r=(n<3?a(r):n>3?a(e,o,r):a(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./player"),c=cc._decorator,s=c.ccclass,l=c.property,p={},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player1=null,e.player2=null,e.pause=!1,e.physicManager=null,e}return a(e,t),e.prototype.onLoad=function(){this.physicManager=cc.director.getPhysicsManager(),this.physicManager.enabled=!0},e.prototype.start=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onKeyDown=function(t){p[t.keyCode]=1},e.prototype.onKeyUp=function(t){p[t.keyCode]=0},e.prototype.keyboardUpdate=function(){this.pause||(this.player1.playerMoveDir("IDLE"),this.player2.playerMoveDir("IDLE"),p[cc.macro.KEY.space]&&this.player1.playerAttack(),p[cc.macro.KEY.s]&&p[cc.macro.KEY.d]?this.player1.playerMoveDir("SE"):p[cc.macro.KEY.d]&&p[cc.macro.KEY.w]?this.player1.playerMoveDir("NE"):p[cc.macro.KEY.w]&&p[cc.macro.KEY.a]?this.player1.playerMoveDir("NW"):p[cc.macro.KEY.a]&&p[cc.macro.KEY.s]?this.player1.playerMoveDir("SW"):p[cc.macro.KEY.a]?this.player1.playerMoveDir("W"):p[cc.macro.KEY.s]?this.player1.playerMoveDir("S"):p[cc.macro.KEY.d]?this.player1.playerMoveDir("E"):p[cc.macro.KEY.w]&&this.player1.playerMoveDir("N"),p[cc.macro.KEY.down]&&p[cc.macro.KEY.right]?this.player2.playerMoveDir("SE"):p[cc.macro.KEY.right]&&p[cc.macro.KEY.up]?this.player2.playerMoveDir("NE"):p[cc.macro.KEY.up]&&p[cc.macro.KEY.left]?this.player2.playerMoveDir("NW"):p[cc.macro.KEY.left]&&p[cc.macro.KEY.down]?this.player2.playerMoveDir("SW"):p[cc.macro.KEY.up]?this.player2.playerMoveDir("N"):p[cc.macro.KEY.down]?this.player2.playerMoveDir("S"):p[cc.macro.KEY.right]?this.player2.playerMoveDir("E"):p[cc.macro.KEY.left]&&this.player2.playerMoveDir("W"))},e.prototype.update=function(){this.keyboardUpdate()},n([l(r.default)],e.prototype,"player1",void 0),n([l(r.default)],e.prototype,"player2",void 0),n([s],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./player":"player"}],player:[function(t,e,o){"use strict";cc._RF.push(e,"734cf13gy1LP7FvtfHFr+av","player");var i,a=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(r=(n<3?a(r):n>3?a(e,o,r):a(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletPrefab=null,e.moveDir="S",e.speed=250,e.anim=null,e.animateState=null,e.maxBullet=5,e.bulletPool=null,e.nextAttackTime=0,e.nextReloadTime=0,e.attackCooldown=.2,e.reloadCooldown=5,e.attacking=!1,e.enemys=null,e.enemyCount=0,e.targetPosition=cc.v2(0,0),e.targetDirection="",e.nextTraceTime=0,e.traceCooldown=.5,e}return a(e,t),e.prototype.onLoad=function(){this.bulletPool=new cc.NodePool("bullet"),this.anim=this.getComponent(cc.Animation),this.enemys=cc.find("Canvas/enemy"),this.enemyCount=this.enemys.childrenCount},e.prototype.start=function(){for(var t=0;t<this.maxBullet;t++){var e=cc.instantiate(this.bulletPrefab);this.bulletPool.put(e)}},e.prototype.playerMoveDir=function(t){this.moveDir=t},e.prototype.playerMove=function(t){switch(this.moveDir){case"N":this.node.y+=this.speed*t;break;case"S":this.node.y-=this.speed*t;break;case"E":this.node.x+=this.speed*t;break;case"W":this.node.x-=this.speed*t;break;case"NE":this.node.x+=this.speed*t,this.node.y+=this.speed*t;break;case"NW":this.node.x-=this.speed*t,this.node.y+=this.speed*t;break;case"SW":this.node.x-=this.speed*t,this.node.y-=this.speed*t;break;case"SE":this.node.x+=this.speed*t,this.node.y-=this.speed*t}},e.prototype.playerWalkAnimation=function(){if(!this.attacking)switch(this.moveDir){case"N":null!=this.animateState&&"playerWalkN"==this.animateState.name||(this.animateState=this.anim.play("playerWalkN"));break;case"S":null!=this.animateState&&"playerWalkS"==this.animateState.name||(this.animateState=this.anim.play("playerWalkS"));break;case"E":null!=this.animateState&&"playerWalkE"==this.animateState.name||(this.animateState=this.anim.play("playerWalkE"));break;case"W":null!=this.animateState&&"playerWalkW"==this.animateState.name||(this.animateState=this.anim.play("playerWalkW"));break;case"NE":null!=this.animateState&&"playerWalkNE"==this.animateState.name||(this.animateState=this.anim.play("playerWalkNE"));break;case"NW":null!=this.animateState&&"playerWalkNW"==this.animateState.name||(this.animateState=this.anim.play("playerWalkNW"));break;case"SW":null!=this.animateState&&"playerWalkSW"==this.animateState.name||(this.animateState=this.anim.play("playerWalkSW"));break;case"SE":null!=this.animateState&&"playerWalkSE"==this.animateState.name||(this.animateState=this.anim.play("playerWalkSE"));break;default:this.anim.stop()}},e.prototype.playerAttackAnimation=function(){var t,e,o=this,i=(t=this.targetPosition.x-this.node.x,e=this.targetPosition.y-this.node.y,180*Math.atan2(e,t)/Math.PI);this.targetDirection=i<157.5&&i>=112.5?"NW":i<112.5&&i>=67.5?"N":i<67.5&&i>=22.5?"NE":i<22.5&&i>=-22.5?"E":i<-22.5&&i>=-67.5?"SE":i<-67.5&&i>=-112.5?"S":i<-112.5&&i>=-157.5?"SW":"W",this.anim.stop(),this.attacking=!0,this.animateState=this.anim.play("playerAttack"+this.targetDirection),this.anim.on("finished",function(){o.attacking=!1})},e.prototype.playerAttack=function(){var t=cc.director.getTotalTime()/1e3;t>=this.nextAttackTime&&(this.nextAttackTime=t+this.attackCooldown,this.createBullet(),this.playerAttackAnimation())},e.prototype.createBullet=function(){var t=null;this.bulletPool.size()>0&&(t=this.bulletPool.get(this.bulletPool)),null!=t&&t.getComponent("bullet").init(this.node,this.targetPosition,this.targetDirection)},e.prototype.traceEnemy=function(){var t=cc.director.getTotalTime()/1e3;if(t>=this.nextTraceTime){this.nextTraceTime=t+this.traceCooldown;for(var e=9007199254740992,o=cc.v2(0,0),i=0;i<this.enemyCount;i++){var a=this.node.position.sub(this.enemys.children[i].position).mag();a<e&&(e=a,o=cc.v2(this.enemys.children[i].position.x,this.enemys.children[i].position.y))}this.targetPosition=o}},e.prototype.update=function(t){this.playerMove(t),this.playerWalkAnimation(),this.traceEnemy()},n([s(cc.Prefab)],e.prototype,"bulletPrefab",void 0),n([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}]},{},["bullet","enemy","gamerManager","player"]);