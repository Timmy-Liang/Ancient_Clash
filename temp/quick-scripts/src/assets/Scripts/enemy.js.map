{"version":3,"sources":["assets/Scripts/enemy.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport player from './player'\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class enemy extends cc.Component {\n\n    @property(player)\n    player1: player = null;\n\n    @property(player)\n    player2: player = null;\n\n    private detectRange: number = 100;\n    private attackRange: number = 5;\n    private attackCooldown: number = 1;\n    private moveSpeed: number = 40;\n    private tracingPlayer: number = 0;\n\n    private moveDir: cc.Vec2 = cc.Vec2.ZERO;\n    private moveDuration = 2.0;\n    private waitDuration = 1.5;\n    private nextWaitTime = 0;\n    private nextMoveTime = 0;\n    private waitRandomFactor = 0.1;\n\n    onLoad() {\n\n    }\n\n    start() {\n\n    }\n\n    wandering(dt: number) {\n        let currentTime = cc.director.getTotalTime() / 1000.0;\n        if (currentTime >= this.nextMoveTime) {\n            this.nextWaitTime = currentTime + this.moveDuration;\n            this.nextMoveTime = this.nextWaitTime + this.waitDuration * (1.0 + this.waitRandomFactor * (Math.random() * 2.0 - 1.0));\n            this.moveDir = randomPointOnUnitCircle();\n        }\n        if (currentTime < this.nextWaitTime) {\n            this.node.x += this.moveDir.x * this.moveSpeed * dt;\n            this.node.y += this.moveDir.y * this.moveSpeed * dt;\n        }\n    }\n\n    tracing(dt: number) {\n        let _dir: cc.Vec3 = cc.v3(0, 0, 0);\n        if(this.tracingPlayer == 1)\n            _dir = this.player1.node.position.sub(this.node.position).normalize();\n        else\n            _dir = this.player2.node.position.sub(this.node.position).normalize();\n        this.moveDir = cc.v2(_dir.x, _dir.y);\n\n        this.node.x += this.moveDir.x * this.moveSpeed * dt;\n        this.node.y += this.moveDir.y * this.moveSpeed * dt;\n    }\n\n\n    detectRangePlayer() {\n        if (this.node.position.sub(this.player1.node.position).mag() < this.detectRange){\n            this.moveSpeed = 200;\n            this.tracingPlayer = 1;\n        }\n        if (this.node.position.sub(this.player2.node.position).mag() < this.detectRange){\n            this.tracingPlayer = 2;\n            this.moveSpeed = 200;\n        }\n\n        \n        return 0;\n    }\n\n\n    update(dt) {\n        if (!this.tracingPlayer) {\n            this.wandering(dt);\n            this.detectRangePlayer();\n        }\n        else {\n            this.tracing(dt);\n        }\n    }\n}\n\n\nfunction randomPointOnUnitCircle() {\n    let angle = Math.random() * Math.PI * 2;\n    return new cc.Vec2(Math.cos(angle), Math.sin(angle));\n}"]}